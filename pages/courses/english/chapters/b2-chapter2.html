<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English B2 - Chapter 2: Complex Phrasal Verbs and Idiomatic Expressions</title>
    <link rel="stylesheet" href="../../css/styles.css">
    <style>
        .chapter-container {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
        }
        
        .level-badge {
            display: inline-block;
            padding: 5px 15px;
            background: var(--primary-color);
            color: white;
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .content-section {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
        }

        .question-container {
            background: var(--card-bg);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            display: none;
        }

        .question-container.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-container.correct {
            border-left: 4px solid #4caf50;
        }

        .question-container.incorrect {
            border-left: 4px solid #f44336;
        }

        .answer-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .answer-input:focus {
            border-color: #007bff;
            outline: none;
        }

        .answer-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .answer-option {
            padding: 12px;
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .answer-option:hover {
            background: #e9e9e9;
        }

        .answer-option.selected {
            background: #cce5ff;
            border-color: #007bff;
        }

        .check-answer-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.2s ease;
        }

        .check-answer-btn:hover {
            background: #0069d9;
        }

        .answer-result {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            display: none;
        }

        .answer-result.correct {
            display: block;
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }

        .answer-result.incorrect {
            display: block;
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #f44336;
        }

        .progress-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .progress-bar {
            flex-grow: 1;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #4caf50;
            width: 0%;
            transition: width 0.3s ease;
        }

        .streak-counter {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            font-weight: bold;
            color: #ff9800;
        }

        .streak-icon {
            font-size: 1.5rem;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .nav-button {
            padding: 10px 20px;
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .nav-button:hover:not(:disabled) {
            background: #e0e0e0;
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body data-course-id="english-b2">
    <header>
        <h1>English B2 - Chapter 2: Complex Phrasal Verbs and Idiomatic Expressions</h1>
    </header>

    <main class="chapter-container">
        <div class="level-badge">B2 - Upper Intermediate</div>

        <div class="content-section">
            <h2>Complex Phrasal Verbs and Idiomatic Expressions</h2>
            <p>At the B2 level, you can understand the main ideas of complex text on both concrete and abstract topics, including technical discussions in your field of specialization. You can interact with a degree of fluency and spontaneity that makes regular interaction with native speakers quite possible without strain for either party.</p>
            
            <h3>Advanced Phrasal Verbs</h3>
            <p>Phrasal verbs consist of a verb combined with a preposition or adverb (or both). At B2 level, you should be familiar with less common phrasal verbs:</p>
            <ul>
                <li><strong>Put up with</strong> - to tolerate: "I can't put up with his constant complaining."</li>
                <li><strong>Bring about</strong> - to cause to happen: "The new policy brought about significant changes."</li>
                <li><strong>Look into</strong> - to investigate: "We're looking into the cause of the problem."</li>
                <li><strong>Call off</strong> - to cancel: "The meeting was called off due to bad weather."</li>
            </ul>
            
            <h3>Idiomatic Expressions</h3>
            <p>Idiomatic expressions are phrases whose meaning cannot be determined by the literal definition of the individual words:</p>
            <ul>
                <li><strong>Beat around the bush</strong> - to avoid talking about something directly</li>
                <li><strong>Hit the nail on the head</strong> - to describe exactly what is causing a situation or problem</li>
                <li><strong>Bite off more than you can chew</strong> - to take on more responsibility than you can manage</li>
                <li><strong>A piece of cake</strong> - something very easy to do</li>
            </ul>
        </div>

        <div class="progress-container">
            <span>Progress:</span>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">
                <span id="currentQuestion">1</span>/<span id="totalQuestions">25</span>
            </div>
        </div>

        <div class="streak-counter">
            <span class="streak-icon">ðŸ”¥</span>
            Streak: <span id="currentStreak">0</span>
        </div>

        <div id="questionsContainer">
            <!-- Questions will be dynamically inserted here -->
        </div>

        <div class="navigation-buttons">
            <button class="nav-button" id="prevButton" disabled>Previous</button>
            <button class="nav-button" id="nextButton" disabled>Next</button>
        </div>
    </main>

    <script>
        // Question data
        const questions = [
            {
                id: 1,
                type: 'multipleChoice',
                question: "Complete the sentence with an appropriate phrasal verb: 'The director has decided to _____ the project until next year.'",
                options: [
                    "put on",
                    "put off",
                    "put away",
                    "put down"
                ],
                correctAnswer: 1,
                explanation: "'Put off' means to postpone or delay something until a later time."
            },
            {
                id: 2,
                type: 'multipleChoice',
                question: "Which idiomatic expression means 'to remain calm in a difficult situation'?",
                options: [
                    "Break a leg",
                    "Hit the roof",
                    "Keep your cool",
                    "Spill the beans"
                ],
                correctAnswer: 2,
                explanation: "'Keep your cool' means to remain calm even when facing a challenging or stressful situation."
            },
            {
                id: 3,
                type: 'transformation',
                question: "Rewrite this sentence using a phrasal verb: 'I'll continue searching for information about the topic.'",
                correctAnswer: "I'll look into the topic further.",
                explanation: "'Look into' means to investigate or examine something, which is appropriate for researching a topic."
            },
            {
                id: 4,
                type: 'fillInBlank',
                question: "Complete the sentence with the correct phrasal verb: 'We had to _____ the picnic because of the rain.' (Use a phrasal verb meaning 'to cancel')",
                correctAnswer: "call off",
                explanation: "'Call off' means to cancel a planned event or activity."
            },
            {
                id: 5,
                type: 'multipleChoice',
                question: "What does the idiom 'bite off more than you can chew' mean?",
                options: [
                    "To eat too much food",
                    "To speak before thinking",
                    "To take on more than you can handle",
                    "To be very hungry"
                ],
                correctAnswer: 2,
                explanation: "'Bite off more than you can chew' means to try to do too much or take on more responsibility than you can manage."
            },
            {
                id: 6,
                type: 'multipleChoice',
                question: "Which phrasal verb means 'to tolerate' or 'to endure'?",
                options: [
                    "Put up with",
                    "Look forward to",
                    "Get over with",
                    "Break down with"
                ],
                correctAnswer: 0,
                explanation: "'Put up with' means to tolerate or endure something unpleasant without complaining too much."
            },
            {
                id: 7,
                type: 'fillInBlank',
                question: "Complete the idiom: 'The exam was a _____ of cake for her because she had studied so well.'",
                correctAnswer: "piece",
                explanation: "'A piece of cake' is an idiom meaning something is very easy to do."
            },
            {
                id: 8,
                type: 'trueFalse',
                question: "The phrasal verb 'bring about' means to introduce someone to another person.",
                correctAnswer: false,
                explanation: "'Bring about' actually means to cause something to happen or to produce a result. It does not refer to introducing people."
            },
            {
                id: 9,
                type: 'multipleChoice',
                question: "Which idiomatic expression means 'to discuss the main subject directly, without avoiding it'?",
                options: [
                    "Beat around the bush",
                    "Cut to the chase",
                    "Hit the roof",
                    "Pull someone's leg"
                ],
                correctAnswer: 1,
                explanation: "'Cut to the chase' means to talk about the important aspects directly without wasting time on unnecessary details."
            },
            {
                id: 10,
                type: 'transformation',
                question: "Rewrite this sentence using an appropriate phrasal verb: 'The new government policies caused many changes in the education system.'",
                correctAnswer: "The new government policies brought about many changes in the education system.",
                explanation: "'Bring about' means to cause something to happen or to produce a result."
            },
            {
                id: 11,
                type: 'multipleChoice',
                question: "What does the idiom 'to hit the nail on the head' mean?",
                options: [
                    "To hurt yourself accidentally",
                    "To do construction work",
                    "To describe exactly what is causing a problem",
                    "To make a mistake"
                ],
                correctAnswer: 2,
                explanation: "'To hit the nail on the head' means to describe exactly what is causing a situation or problem - to be exactly right."
            },
            {
                id: 12,
                type: 'fillInBlank',
                question: "Complete the phrasal verb: 'I can't _____ up with his constant complaining anymore.'",
                correctAnswer: "put",
                explanation: "'Put up with' means to tolerate or endure something unpleasant."
            },
            {
                id: 13,
                type: 'multipleChoice',
                question: "Which phrasal verb means 'to recover from an illness or disappointment'?",
                options: [
                    "Get over",
                    "Get on",
                    "Get by",
                    "Get through"
                ],
                correctAnswer: 0,
                explanation: "'Get over' means to recover from an illness, disappointment, or difficult experience."
            },
            {
                id: 14,
                type: 'trueFalse',
                question: "The idiomatic expression 'to be in hot water' means to be in a comfortable situation.",
                correctAnswer: false,
                explanation: "'To be in hot water' actually means to be in trouble or to face problems or criticism."
            },
            {
                id: 15,
                type: 'multipleChoice',
                question: "Which phrasal verb should complete this sentence: 'The meeting has been _____ because the CEO is ill.'",
                options: [
                    "called off",
                    "called out",
                    "called up",
                    "called for"
                ],
                correctAnswer: 0,
                explanation: "'Called off' means canceled. The other options have different meanings: 'call out' (to criticize publicly), 'call up' (to telephone or summon), 'call for' (to require or demand)."
            },
            {
                id: 16,
                type: 'fillInBlank',
                question: "Complete the idiom: 'Stop _____ around the bush and tell me what happened.'",
                correctAnswer: "beating",
                explanation: "'Beating around the bush' is an idiom that means avoiding talking about something directly."
            },
            {
                id: 17,
                type: 'multipleChoice',
                question: "What does the phrasal verb 'run into' mean in this sentence: 'I ran into my old friend at the supermarket yesterday.'",
                options: [
                    "To crash into someone physically",
                    "To meet someone by chance",
                    "To start running with someone",
                    "To encounter a problem"
                ],
                correctAnswer: 1,
                explanation: "In this context, 'run into' means to meet someone unexpectedly or by chance."
            },
            {
                id: 18,
                type: 'transformation',
                question: "Rewrite this sentence using the idiom 'cost an arm and a leg': 'The new laptop was extremely expensive.'",
                correctAnswer: "The new laptop cost an arm and a leg.",
                explanation: "'Cost an arm and a leg' is an idiom meaning something is very expensive."
            },
            {
                id: 19,
                type: 'multipleChoice',
                question: "Which phrasal verb means 'to invent an excuse or explanation'?",
                options: [
                    "Make up",
                    "Make out",
                    "Make off",
                    "Make over"
                ],
                correctAnswer: 0,
                explanation: "'Make up' can mean to invent a story or excuse. It can also mean to reconcile after an argument or to apply cosmetics."
            },
            {
                id: 20,
                type: 'fillInBlank',
                question: "Complete the idiom: 'Finding a job in this economy is like looking for a _____ in a haystack.'",
                correctAnswer: "needle",
                explanation: "'Looking for a needle in a haystack' means trying to find something that is very difficult to locate."
            },
            {
                id: 21,
                type: 'multipleChoice',
                question: "What does the phrasal verb 'look up to' mean?",
                options: [
                    "To search for information",
                    "To admire or respect someone",
                    "To check the meaning of a word",
                    "To visit someone"
                ],
                correctAnswer: 1,
                explanation: "'Look up to' means to admire or respect someone. 'Look up' (without 'to') can mean to search for information or check a word's meaning."
            },
            {
                id: 22,
                type: 'trueFalse',
                question: "The idiom 'to pull someone's leg' means to physically hurt them.",
                correctAnswer: false,
                explanation: "'To pull someone's leg' actually means to joke with someone or to tell them something that is not true as a joke."
            },
            {
                id: 23,
                type: 'multipleChoice',
                question: "Which phrasal verb completes the sentence: 'I need to _____ on my work if I want to finish by tomorrow.'",
                options: [
                    "catch up",
                    "keep up",
                    "take up",
                    "give up"
                ],
                correctAnswer: 0,
                explanation: "'Catch up on' means to do something you should have done earlier or to reach the same level as others."
            },
            {
                id: 24,
                type: 'fillInBlank',
                question: "Complete the idiom: 'I'm so tired, I think I'll _____ the bucket any minute now.' (Meaning 'extremely tired')",
                correctAnswer: "kick",
                explanation: "'Kick the bucket' is an idiom meaning to die, but it's often used humorously to express extreme exhaustion or fatigue."
            },
            {
                id: 25,
                type: 'transformation',
                question: "Rewrite this sentence using the phrasal verb 'figure out': 'After many attempts, she finally understood how to solve the problem.'",
                correctAnswer: "After many attempts, she finally figured out how to solve the problem.",
                explanation: "'Figure out' means to understand or solve something after thinking about it."
            }
        ];

        // Initialize variables
        let currentQuestionIndex = 0;
        let streak = 0;
        let answeredQuestions = new Array(questions.length).fill(false);

        // DOM elements
        const questionsContainer = document.getElementById('questionsContainer');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const currentQuestionElement = document.getElementById('currentQuestion');
        const totalQuestionsElement = document.getElementById('totalQuestions');
        const currentStreakElement = document.getElementById('currentStreak');
        const progressFill = document.getElementById('progressFill');

        // Set total questions
        totalQuestionsElement.textContent = questions.length;

        // Create question elements
        function createQuestionElements() {
            questions.forEach((question, index) => {
                const questionElement = document.createElement('div');
                questionElement.classList.add('question-container');
                questionElement.id = `question-${index}`;
                
                let questionHTML = `<h3>Question ${index + 1}</h3><p>${question.question}</p>`;
                
                if (question.type === 'multipleChoice') {
                    questionHTML += `<div class="answer-options">`;
                    question.options.forEach((option, optIndex) => {
                        questionHTML += `
                            <div class="answer-option" data-index="${optIndex}">
                                ${option}
                            </div>
                        `;
                    });
                    questionHTML += `</div>`;
                } else if (question.type === 'fillInBlank') {
                    questionHTML += `<input type="text" class="answer-input" placeholder="Type your answer">`;
                } else if (question.type === 'trueFalse') {
                    questionHTML += `
                        <div class="answer-options">
                            <div class="answer-option" data-index="true">True</div>
                            <div class="answer-option" data-index="false">False</div>
                        </div>
                    `;
                } else if (question.type === 'transformation') {
                    questionHTML += `<textarea class="answer-input" rows="3" placeholder="Type your answer"></textarea>`;
                }
                
                questionHTML += `
                    <button class="check-answer-btn">Check Answer</button>
                    <div class="answer-result"></div>
                `;
                
                questionElement.innerHTML = questionHTML;
                questionsContainer.appendChild(questionElement);
                
                // Add event listeners
                if (question.type === 'multipleChoice' || question.type === 'trueFalse') {
                    const options = questionElement.querySelectorAll('.answer-option');
                    options.forEach(option => {
                        option.addEventListener('click', () => {
                            options.forEach(opt => opt.classList.remove('selected'));
                            option.classList.add('selected');
                        });
                    });
                }
                
                const checkButton = questionElement.querySelector('.check-answer-btn');
                checkButton.addEventListener('click', () => checkAnswer(index));
            });
            
            // Show first question
            showQuestion(0);
        }

        // Show a specific question
        function showQuestion(index) {
            // Hide all questions
            document.querySelectorAll('.question-container').forEach(el => {
                el.classList.remove('active');
            });
            
            // Show current question
            const currentQuestion = document.getElementById(`question-${index}`);
            currentQuestion.classList.add('active');
            
            // Update current question number
            currentQuestionIndex = index;
            currentQuestionElement.textContent = index + 1;
            
            // Update navigation buttons
            prevButton.disabled = index === 0;
            nextButton.disabled = index === questions.length - 1 || !answeredQuestions[index];
            
            // Update progress bar
            updateProgress();
        }

        // Check answer
        function checkAnswer(index) {
            const question = questions[index];
            const questionElement = document.getElementById(`question-${index}`);
            const resultElement = questionElement.querySelector('.answer-result');
            
            let userAnswer;
            let isCorrect = false;
            
            if (question.type === 'multipleChoice' || question.type === 'trueFalse') {
                const selectedOption = questionElement.querySelector('.answer-option.selected');
                if (!selectedOption) {
                    resultElement.textContent = "Please select an answer.";
                    resultElement.className = "answer-result incorrect";
                    resultElement.style.display = "block";
                    return;
                }
                
                userAnswer = selectedOption.getAttribute('data-index');
                if (question.type === 'trueFalse') {
                    isCorrect = (userAnswer === "true") === question.correctAnswer;
                } else {
                    isCorrect = parseInt(userAnswer) === question.correctAnswer;
                }
            } else {
                const inputElement = questionElement.querySelector('.answer-input');
                userAnswer = inputElement.value.trim().toLowerCase();
                const correctAnswer = question.correctAnswer.toLowerCase();
                
                // For transformation questions, we'll be more lenient
                if (question.type === 'transformation') {
                    // Check if the key parts of the answer are included
                    const keyParts = correctAnswer.split(' ');
                    const essentialWords = keyParts.filter(word => word.length > 3);
                    const matchCount = essentialWords.filter(word => 
                        userAnswer.includes(word.toLowerCase())
                    ).length;
                    
                    isCorrect = matchCount >= Math.ceil(essentialWords.length * 0.7);
                } else if (question.type === 'fillInBlank') {
                    // For these specific answers
                    if (correctAnswer === "piece") {
                        isCorrect = userAnswer === "piece";
                    } else if (correctAnswer === "put") {
                        isCorrect = userAnswer === "put";
                    } else if (correctAnswer === "beating") {
                        isCorrect = userAnswer === "beating";
                    } else if (correctAnswer === "needle") {
                        isCorrect = userAnswer === "needle";
                    } else if (correctAnswer === "kick") {
                        isCorrect = userAnswer === "kick";
                    } else if (correctAnswer === "call off") {
                        isCorrect = userAnswer === "call off";
                    } else {
                        isCorrect = userAnswer === correctAnswer;
                    }
                } else {
                    isCorrect = userAnswer === correctAnswer;
                }
            }
            
            // Update UI based on result
            questionElement.classList.remove('correct', 'incorrect');
            questionElement.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            resultElement.textContent = isCorrect ? 
                `Correct! ${question.explanation}` : 
                `Incorrect. The correct answer is: ${question.correctAnswer}. ${question.explanation}`;
            resultElement.className = `answer-result ${isCorrect ? 'correct' : 'incorrect'}`;
            resultElement.style.display = "block";
            
            // Update streak
            if (isCorrect) {
                streak++;
                if (!answeredQuestions[index]) {
                    answeredQuestions[index] = true;
                }
            } else {
                streak = 0;
            }
            currentStreakElement.textContent = streak;
            
            // Enable next button if answer is correct
            nextButton.disabled = index === questions.length - 1 || !answeredQuestions[index];
            
            // Update progress
            updateProgress();
        }

        // Update progress bar
        function updateProgress() {
            const progress = (answeredQuestions.filter(Boolean).length / questions.length) * 100;
            progressFill.style.width = `${progress}%`;
        }

        // Navigation event listeners
        prevButton.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                showQuestion(currentQuestionIndex - 1);
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentQuestionIndex < questions.length - 1 && answeredQuestions[currentQuestionIndex]) {
                showQuestion(currentQuestionIndex + 1);
            }
        });

        // Initialize the page
        createQuestionElements();
    </script>
    
    <script src="/assets/js/auth-protection.js"></script>
    <script src="/assets/js/tracking.js"></script>
</body>
</html>
            </div>
        </section>
    </main>
    <script src="/assets/js/auth-protection.js"></script>
    <script src="/assets/js/tracking.js"></script>
</body>
</html>
