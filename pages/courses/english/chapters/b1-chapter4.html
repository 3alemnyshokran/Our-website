<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Describing Experiences - B1 Level | Chapter 4</title>
    <link rel="stylesheet" href="../../css/styles.css">
    <style>
        .chapter-container {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
        }
        
        .level-badge {
            display: inline-block;
            padding: 5px 15px;
            background: var(--primary-color);
            color: white;
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .content-section {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
        }

        .question-container {
            background: var(--card-bg);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            display: none;
        }

        .question-container.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-container.correct {
            border-left: 4px solid #4caf50;
        }

        .question-container.incorrect {
            border-left: 4px solid #f44336;
        }

        .answer-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .answer-input:focus {
            border-color: #007bff;
            outline: none;
        }

        .answer-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .answer-option {
            padding: 12px;
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .answer-option:hover {
            background: #e9e9e9;
        }

        .answer-option.selected {
            background: #cce5ff;
            border-color: #007bff;
        }

        .check-answer-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.2s ease;
        }

        .check-answer-btn:hover {
            background: #0069d9;
        }

        .answer-result {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            display: none;
        }

        .answer-result.correct {
            display: block;
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }

        .answer-result.incorrect {
            display: block;
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #f44336;
        }

        .progress-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .progress-bar {
            flex-grow: 1;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #4caf50;
            width: 0%;
            transition: width 0.3s ease;
        }

        .streak-counter {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            font-weight: bold;
            color: #ff9800;
        }

        .streak-icon {
            font-size: 1.5rem;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .nav-button {
            padding: 10px 20px;
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .nav-button:hover:not(:disabled) {
            background: #e0e0e0;
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body data-course-id="english-b1">
    <header>
        <h1>English B1 - Chapter 4: Describing Experiences</h1>
    </header>

    <main class="chapter-container">
        <div class="level-badge">B1 - Threshold</div>

        <div class="content-section">
            <h2>Describing Experiences</h2>
            <p>At the B1 level, you can talk about your past experiences and connect them to the present using the present perfect tense. This tense is essential for describing life experiences, recent activities, and ongoing situations.</p>
            
            <h3>Present Perfect Tense Structure</h3>
            <ul>
                <li><strong>Form:</strong> have/has + past participle</li>
                <li><strong>Examples:</strong> "I have visited Paris.", "She has studied English for five years."</li>
            </ul>
            
            <h3>When to Use the Present Perfect</h3>
            <ul>
                <li><strong>Life experiences:</strong> "I have traveled to many countries."</li>
                <li><strong>Recent actions with present relevance:</strong> "I've just finished my homework."</li>
                <li><strong>Unfinished actions continuing to the present:</strong> "I have lived here for ten years."</li>
                <li><strong>With 'ever' and 'never':</strong> "Have you ever eaten sushi?", "I have never seen snow."</li>
                <li><strong>With 'already', 'yet', and 'still':</strong> "I have already read that book.", "Have you finished yet?", "I still haven't decided."</li>
            </ul>
            
            <h3>Time Expressions with Present Perfect</h3>
            <ul>
                <li><strong>For:</strong> Used with a period of time - "I have studied English for five years."</li>
                <li><strong>Since:</strong> Used with a starting point - "She has lived here since 2010."</li>
                <li><strong>Recently:</strong> "I have recently changed my job."</li>
                <li><strong>Lately:</strong> "Have you seen any good movies lately?"</li>
                <li><strong>In the last few days/weeks/months/years:</strong> "I have visited my grandmother twice in the last month."</li>
            </ul>
        </div>

        <div class="progress-container">
            <span>Progress:</span>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">
                <span id="currentQuestion">1</span>/<span id="totalQuestions">25</span>
            </div>
        </div>

        <div class="streak-counter">
            <span class="streak-icon">ðŸ”¥</span>
            Streak: <span id="currentStreak">0</span>
        </div>

        <div id="questionsContainer">
            <!-- Questions will be dynamically inserted here -->
        </div>

        <div class="navigation-buttons">
            <button class="nav-button" id="prevButton" disabled>Previous</button>
            <button class="nav-button" id="nextButton" disabled>Next</button>
        </div>
    </main>

    <script>
        // Question data
        const questions = [
            {
                id: 1,
                type: 'multipleChoice',
                question: "Which of these sentences uses the present perfect correctly?",
                options: [
                    "I gone to Paris last year.",
                    "She have visited her grandmother.",
                    "They has eaten lunch.",
                    "We have seen that movie twice."
                ],
                correctAnswer: 3,
                explanation: "'We have seen that movie twice' correctly uses 'have' with the plural subject 'we' and the past participle 'seen'."
            },
            {
                id: 2,
                type: 'fillInBlank',
                question: "Complete the sentence: 'She _____ worked here for five years.'",
                correctAnswer: "has",
                explanation: "With the third person singular subject 'she', we use 'has' in the present perfect."
            },
            {
                id: 3,
                type: 'multipleChoice',
                question: "Which time expression is NOT typically used with the present perfect?",
                options: [
                    "since",
                    "for",
                    "yesterday",
                    "recently"
                ],
                correctAnswer: 2,
                explanation: "'Yesterday' is a specific time in the past, so it's used with the past simple tense, not the present perfect."
            },
            {
                id: 4,
                type: 'trueFalse',
                question: "The sentence 'I have lived in London since three years' is grammatically correct.",
                correctAnswer: false,
                explanation: "This is incorrect. With 'since', we need a point in time (e.g., 'since 2020'). For a period of time, we use 'for' (e.g., 'for three years')."
            },
            {
                id: 5,
                type: 'multipleChoice',
                question: "What is the past participle of the verb 'go'?",
                options: [
                    "goed",
                    "went",
                    "gone",
                    "going"
                ],
                correctAnswer: 2,
                explanation: "The past participle of 'go' is 'gone'. In the present perfect, we say 'have gone' or 'has gone'."
            },
            {
                id: 6,
                type: 'transformation',
                question: "Transform this sentence into the present perfect: 'I visit France.' (Use 'never' in your answer)",
                correctAnswer: "I have never visited France.",
                explanation: "To transform to present perfect with 'never', we use 'have/has never + past participle'."
            },
            {
                id: 7,
                type: 'multipleChoice',
                question: "Which sentence expresses an experience without specifying when it happened?",
                options: [
                    "I saw a dolphin yesterday.",
                    "I have seen a dolphin.",
                    "I was seeing a dolphin.",
                    "I will see a dolphin."
                ],
                correctAnswer: 1,
                explanation: "'I have seen a dolphin' uses the present perfect to talk about an experience at an unspecified time in the past."
            },
            {
                id: 8,
                type: 'fillInBlank',
                question: "Complete the sentence: 'Have you _____ been to Japan?'",
                correctAnswer: "ever",
                explanation: "'Ever' is used in questions with the present perfect to ask about experiences at any time in someone's life."
            },
            {
                id: 9,
                type: 'multipleChoice',
                question: "Which of these verbs is in its past participle form?",
                options: [
                    "eat",
                    "eating",
                    "ate",
                    "eaten"
                ],
                correctAnswer: 3,
                explanation: "'Eaten' is the past participle form of 'eat', used in perfect tenses like 'have eaten'."
            },
            {
                id: 10,
                type: 'trueFalse',
                question: "The present perfect is used to talk about specific finished actions at a specific time in the past.",
                correctAnswer: false,
                explanation: "The present perfect is used for experiences, recent actions with present relevance, and unfinished actions continuing to the present, not for specific finished actions at a specific time in the past (which would use the past simple)."
            },
            {
                id: 11,
                type: 'fillInBlank',
                question: "Complete the sentence: 'They have lived here _____ 2015.'",
                correctAnswer: "since",
                explanation: "'Since' is used with a specific point in time from which an action started and continues to the present."
            },
            {
                id: 12,
                type: 'multipleChoice',
                question: "Which question is asking about a recent experience?",
                options: [
                    "Did you see that movie?",
                    "Will you see that movie?",
                    "Have you seen that movie yet?",
                    "Are you seeing that movie?"
                ],
                correctAnswer: 2,
                explanation: "'Have you seen that movie yet?' uses the present perfect to ask about a recent experience, with 'yet' suggesting we expect it might have happened."
            },
            {
                id: 13,
                type: 'transformation',
                question: "Transform this sentence to show that the action is still continuing: 'I study English.' (Use 'for five years' in your answer)",
                correctAnswer: "I have studied English for five years.",
                explanation: "Using the present perfect with 'for five years' shows that the action started in the past and continues to the present."
            },
            {
                id: 14,
                type: 'multipleChoice',
                question: "Which sentence correctly uses 'already' with the present perfect?",
                options: [
                    "I already have seen that movie.",
                    "I have already seen that movie.",
                    "I have seen already that movie.",
                    "Already I have seen that movie."
                ],
                correctAnswer: 1,
                explanation: "'I have already seen that movie' places 'already' between the auxiliary verb 'have' and the past participle 'seen', which is the correct position."
            },
            {
                id: 15,
                type: 'fillInBlank',
                question: "Complete the sentence: 'She has _____ (not finish) her homework yet.'",
                correctAnswer: "not finished",
                explanation: "To make the present perfect negative, we use 'have/has not + past participle', so 'has not finished' is correct."
            },
            {
                id: 16,
                type: 'multipleChoice',
                question: "Which of these verbs is irregular in its past participle form?",
                options: [
                    "walk (walked)",
                    "talk (talked)",
                    "drink (drunk)",
                    "work (worked)"
                ],
                correctAnswer: 2,
                explanation: "'Drink' is irregular. Its past participle is 'drunk', not 'drinked'."
            },
            {
                id: 17,
                type: 'trueFalse',
                question: "In the sentence 'I've been to Paris', the contraction 'I've' stands for 'I have'.",
                correctAnswer: true,
                explanation: "The contraction 'I've' is short for 'I have', which is the auxiliary verb in the present perfect tense."
            },
            {
                id: 18,
                type: 'multipleChoice',
                question: "Which sentence shows an action that started in the past and continues to the present?",
                options: [
                    "I lived in London for three years.",
                    "I have lived in London for three years.",
                    "I will live in London for three years.",
                    "I am living in London for three years."
                ],
                correctAnswer: 1,
                explanation: "'I have lived in London for three years' uses the present perfect to show that the action of living in London started three years ago and continues to the present."
            },
            {
                id: 19,
                type: 'fillInBlank',
                question: "Complete the sentence: 'Have you _____ your lunch?' (using a word that means 'before now')",
                correctAnswer: "already",
                explanation: "'Already' is used in questions to ask if something has happened sooner than expected."
            },
            {
                id: 20,
                type: 'multipleChoice',
                question: "Which sentence is grammatically correct?",
                options: [
                    "I have went to the store.",
                    "She has ate dinner.",
                    "They have driven to work.",
                    "He have saw a movie."
                ],
                correctAnswer: 2,
                explanation: "'They have driven to work' correctly uses 'have' with the plural subject 'they' and the correct past participle 'driven'."
            },
            {
                id: 21,
                type: 'transformation',
                question: "Transform this sentence to the present perfect: 'She visits her parents last week.'",
                correctAnswer: "She has visited her parents.",
                explanation: "The transformed sentence removes the specific time reference 'last week' (which would require past simple) and uses the present perfect structure 'has visited'."
            },
            {
                id: 22,
                type: 'multipleChoice',
                question: "Which question asks about lifetime experiences?",
                options: [
                    "Did you travel abroad?",
                    "Have you ever traveled abroad?",
                    "Will you travel abroad?",
                    "Are you traveling abroad?"
                ],
                correctAnswer: 1,
                explanation: "'Have you ever traveled abroad?' uses 'ever' with the present perfect to ask about experiences at any time in someone's life up to now."
            },
            {
                id: 23,
                type: 'fillInBlank',
                question: "Complete the sentence: 'They have _____ (be) friends since childhood.'",
                correctAnswer: "been",
                explanation: "The past participle of 'be' is 'been', so 'have been' is the correct present perfect form."
            },
            {
                id: 24,
                type: 'multipleChoice',
                question: "Which of these would you NOT use with the present perfect?",
                options: [
                    "recently",
                    "just",
                    "already",
                    "last week"
                ],
                correctAnswer: 3,
                explanation: "'Last week' refers to a specific time in the past, so it's used with the past simple, not the present perfect."
            },
            {
                id: 25,
                type: 'trueFalse',
                question: "The sentence 'I have visited Paris three times' tells us when these visits occurred.",
                correctAnswer: false,
                explanation: "This sentence tells us how many times the visits occurred (three times) but not when they happened. The present perfect doesn't specify when past actions occurred."
            }
        ];

        // Initialize variables
        let currentQuestionIndex = 0;
        let streak = 0;
        let answeredQuestions = new Array(questions.length).fill(false);

        // DOM elements
        const questionsContainer = document.getElementById('questionsContainer');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const currentQuestionElement = document.getElementById('currentQuestion');
        const totalQuestionsElement = document.getElementById('totalQuestions');
        const currentStreakElement = document.getElementById('currentStreak');
        const progressFill = document.getElementById('progressFill');

        // Set total questions
        totalQuestionsElement.textContent = questions.length;

        // Create question elements
        function createQuestionElements() {
            questions.forEach((question, index) => {
                const questionElement = document.createElement('div');
                questionElement.classList.add('question-container');
                questionElement.id = `question-${index}`;
                
                let questionHTML = `<h3>Question ${index + 1}</h3><p>${question.question}</p>`;
                
                if (question.type === 'multipleChoice') {
                    questionHTML += `<div class="answer-options">`;
                    question.options.forEach((option, optIndex) => {
                        questionHTML += `
                            <div class="answer-option" data-index="${optIndex}">
                                ${option}
                            </div>
                        `;
                    });
                    questionHTML += `</div>`;
                } else if (question.type === 'fillInBlank') {
                    questionHTML += `<input type="text" class="answer-input" placeholder="Type your answer">`;
                } else if (question.type === 'trueFalse') {
                    questionHTML += `
                        <div class="answer-options">
                            <div class="answer-option" data-index="true">True</div>
                            <div class="answer-option" data-index="false">False</div>
                        </div>
                    `;
                } else if (question.type === 'transformation') {
                    questionHTML += `<input type="text" class="answer-input" placeholder="Type your answer">`;
                }
                
                questionHTML += `
                    <button class="check-answer-btn">Check Answer</button>
                    <div class="answer-result"></div>
                `;
                
                questionElement.innerHTML = questionHTML;
                questionsContainer.appendChild(questionElement);
                
                // Add event listeners
                if (question.type === 'multipleChoice' || question.type === 'trueFalse') {
                    const options = questionElement.querySelectorAll('.answer-option');
                    options.forEach(option => {
                        option.addEventListener('click', () => {
                            options.forEach(opt => opt.classList.remove('selected'));
                            option.classList.add('selected');
                        });
                    });
                }
                
                const checkButton = questionElement.querySelector('.check-answer-btn');
                checkButton.addEventListener('click', () => checkAnswer(index));
            });
            
            // Show first question
            showQuestion(0);
        }

        // Show a specific question
        function showQuestion(index) {
            // Hide all questions
            document.querySelectorAll('.question-container').forEach(el => {
                el.classList.remove('active');
            });
            
            // Show current question
            const currentQuestion = document.getElementById(`question-${index}`);
            currentQuestion.classList.add('active');
            
            // Update current question number
            currentQuestionIndex = index;
            currentQuestionElement.textContent = index + 1;
            
            // Update navigation buttons
            prevButton.disabled = index === 0;
            nextButton.disabled = index === questions.length - 1 || !answeredQuestions[index];
            
            // Update progress bar
            updateProgress();
        }

        // Check answer
        function checkAnswer(index) {
            const question = questions[index];
            const questionElement = document.getElementById(`question-${index}`);
            const resultElement = questionElement.querySelector('.answer-result');
            
            let userAnswer;
            let isCorrect = false;
            
            if (question.type === 'multipleChoice' || question.type === 'trueFalse') {
                const selectedOption = questionElement.querySelector('.answer-option.selected');
                if (!selectedOption) {
                    resultElement.textContent = "Please select an answer.";
                    resultElement.className = "answer-result incorrect";
                    return;
                }
                
                userAnswer = selectedOption.getAttribute('data-index');
                if (question.type === 'trueFalse') {
                    isCorrect = (userAnswer === "true") === question.correctAnswer;
                } else {
                    isCorrect = parseInt(userAnswer) === question.correctAnswer;
                }
            } else {
                const inputElement = questionElement.querySelector('.answer-input');
                userAnswer = inputElement.value.trim().toLowerCase();
                const correctAnswer = question.correctAnswer.toLowerCase();
                
                // For transformation questions, we'll be more lenient
                if (question.type === 'transformation') {
                    // Check if the key parts of the answer are included
                    const keyParts = correctAnswer.split(' ');
                    const essentialWords = keyParts.filter(word => word.length > 3);
                    const matchCount = essentialWords.filter(word => 
                        userAnswer.includes(word.toLowerCase())
                    ).length;
                    
                    isCorrect = matchCount >= Math.ceil(essentialWords.length * 0.7);
                } else {
                    // For fill in the blank, allow for some common variations
                    if (correctAnswer === "has") {
                        isCorrect = userAnswer === "has";
                    } else if (correctAnswer === "ever") {
                        isCorrect = userAnswer === "ever";
                    } else if (correctAnswer === "since") {
                        isCorrect = userAnswer === "since";
                    } else if (correctAnswer === "not finished") {
                        isCorrect = userAnswer === "not finished" || userAnswer === "not finish";
                    } else if (correctAnswer === "already") {
                        isCorrect = userAnswer === "already" || userAnswer === "yet";
                    } else if (correctAnswer === "been") {
                        isCorrect = userAnswer === "been";
                    } else {
                        isCorrect = userAnswer === correctAnswer;
                    }
                }
            }
            
            // Update UI based on result
            questionElement.classList.remove('correct', 'incorrect');
            questionElement.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            resultElement.textContent = isCorrect ? 
                `Correct! ${question.explanation}` : 
                `Incorrect. The correct answer is: ${question.correctAnswer}. ${question.explanation}`;
            resultElement.className = `answer-result ${isCorrect ? 'correct' : 'incorrect'}`;
            
            // Update streak
            if (isCorrect) {
                streak++;
                if (!answeredQuestions[index]) {
                    answeredQuestions[index] = true;
                }
            } else {
                streak = 0;
            }
            currentStreakElement.textContent = streak;
            
            // Enable next button if answer is correct
            nextButton.disabled = index === questions.length - 1 || !answeredQuestions[index];
            
            // Update progress
            updateProgress();
        }

        // Update progress bar
        function updateProgress() {
            const progress = (answeredQuestions.filter(Boolean).length / questions.length) * 100;
            progressFill.style.width = `${progress}%`;
        }

        // Navigation event listeners
        prevButton.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                showQuestion(currentQuestionIndex - 1);
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentQuestionIndex < questions.length - 1 && answeredQuestions[currentQuestionIndex]) {
                showQuestion(currentQuestionIndex + 1);
            }
        });

        // Initialize the page
        createQuestionElements();
    </script>
</body>
</html>
